<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AI Portfolio</title>
    <style>
        :root { --bg: #0f172a; --card: #1e293b; --primary: #38bdf8; --text: #f8fafc; }
        body { font-family: sans-serif; background: var(--bg); color: var(--text); margin: 0; }
        .container { max-width: 900px; margin: 0 auto; padding: 50px 20px; }
        section { margin-bottom: 60px; }
        h1 { color: var(--primary); font-size: 3rem; }
        .grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 20px; }
        .card { background: var(--card); padding: 20px; border-radius: 12px; border: 1px solid #334155; }
        
        /* Chat Widget */
        #chat-win { position: fixed; bottom: 80px; right: 20px; width: 320px; height: 400px; 
                    background: var(--card); border-radius: 12px; display: none; flex-direction: column; 
                    border: 1px solid var(--primary); box-shadow: 0 10px 30px rgba(0,0,0,0.5); }
        #messages { flex: 1; overflow-y: auto; padding: 15px; font-size: 14px; }
        #input-area { display: flex; padding: 10px; border-top: 1px solid #334155; }
        input { flex: 1; background: #0f172a; border: 1px solid #334155; color: white; padding: 8px; border-radius: 5px; }
        #toggle-btn { position: fixed; bottom: 20px; right: 20px; background: var(--primary); 
                      border: none; width: 50px; height: 50px; border-radius: 50%; cursor: pointer; font-weight: bold; }
        .msg { margin-bottom: 10px; padding: 8px; border-radius: 5px; }
        .user { background: #0369a1; text-align: right; }
        .ai { background: #334155; }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <h1>Halo, Saya Developer Portofolio</h1>
            <p>Membangun masa depan dengan AI dan Kode.</p>
        </header>
        <section>
            <h2>Proyek</h2>
            <div class="grid">
                <div class="card"><h3>AI Chatbot</h3><p>Integrasi Groq API.</p></div>
                <div class="card"><h3>Web Apps</h3><p>Fullstack Vercel Deploy.</p></div>
            </div>
        </section>
    </div>

    <button id="toggle-btn" onclick="document.getElementById('chat-win').style.display === 'flex' ? document.getElementById('chat-win').style.display = 'none' : document.getElementById('chat-win').style.display = 'flex'">AI</button>
    <div id="chat-win">
        <div id="messages"></div>
        <div id="input-area">
            <input type="text" id="userInput" placeholder="Tanya saya...">
            <button onclick="askAI()" style="margin-left:5px">Kirim</button>
        </div>
    </div>

    <script>
        async function askAI() {
            const input = document.getElementById('userInput');
            const msgBox = document.getElementById('messages');
            const val = input.value;
            if(!val) return;

            msgBox.innerHTML += `<div class="msg user">${val}</div>`;
            input.value = '';

            try {
                const res = await fetch('/api/chat', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({ messages: [{role: "user", content: val}] })
                });
                const data = await res.json();
                msgBox.innerHTML += `<div class="msg ai">${data.reply}</div>`;
            } catch (e) {
                msgBox.innerHTML += `<div class="msg ai">Error connecting to server.</div>`;
            }
            msgBox.scrollTop = msgBox.scrollHeight;
        }
    </script>
</body>
</html>

